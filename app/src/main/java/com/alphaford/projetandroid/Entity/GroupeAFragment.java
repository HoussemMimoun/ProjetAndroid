package com.alphaford.projetandroid.Entity;import android.content.Intent;import android.graphics.Color;import android.graphics.Typeface;import android.os.AsyncTask;import android.os.Bundle;import android.support.v4.app.Fragment;import android.support.v7.widget.GridLayoutManager;import android.support.v7.widget.RecyclerView;import android.text.util.Linkify;import android.util.Log;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.AdapterView;import android.widget.ImageView;import android.widget.ListView;import android.widget.Switch;import android.widget.TableLayout;import android.widget.TableRow;import android.widget.TextView;import com.alphaford.projetandroid.PoolActivity;import com.alphaford.projetandroid.R;import com.android.volley.RequestQueue;import com.android.volley.VolleyError;import com.android.volley.toolbox.JsonArrayRequest;import com.android.volley.toolbox.StringRequest;import com.android.volley.toolbox.Volley;import com.bumptech.glide.Glide;import org.json.JSONArray;import org.json.JSONException;import org.json.JSONObject;import java.io.IOException;import java.text.DateFormat;import java.text.ParseException;import java.text.SimpleDateFormat;import java.util.ArrayList;import java.util.Date;import java.util.List;import java.util.Locale;import okhttp3.OkHttpClient;import okhttp3.Request;import okhttp3.Response;public class GroupeAFragment extends Fragment {    RequestQueue req;    RequestQueue req1;    String url = "http://192.168.1.3/e.php";    String url1 = "http://192.168.1.3/a.php";    private RecyclerView recyclerView;   // private List<Partie> parties;    private List<Partie> listee ;    private PartieAdapter adaptere;    private GridLayoutManager gridLayout;    private ListView liste;    private CustomListAdapter adapter;   String result = null;    @Override    public View onCreateView(LayoutInflater inflater, ViewGroup container,                             Bundle savedInstanceState) {       View view =  inflater.inflate(R.layout.fragment_groupe_a, container, false);        recyclerView = (RecyclerView) view.findViewById(R.id.recyclerview1);       listee = new ArrayList<>();        liste = (ListView) view.findViewById(R.id.lste);        adapter = new CustomListAdapter(getActivity(), listee);        liste.setAdapter(adapter);     //   gridLayout = new GridLayoutManager(getContext(), 1);     //   recyclerView.setLayoutManager(gridLayout);     //   adaptere = new PartieAdapter(getContext(), parties);    //    recyclerView.setAdapter(adaptere);    //    recyclerView.addOnScrollListener(new RecyclerView.OnScrollListener() {      //      @Override        //    public void onScrolled(RecyclerView recyclerView, int dx, int dy) {          //      if (gridLayout.findLastCompletelyVisibleItemPosition() == parties.size() - 1) {            //        getPartiesFromDB(parties.get(parties.size() - 1).getId_match());            //    }//            }  //      });        sendjsonrequest();        sendjsonReq();        return  view;    }    public void sendjsonrequest() {        final JsonArrayRequest jsonArrayRequest = new JsonArrayRequest(com.android.volley.Request.Method.GET, url, null, new com.android.volley.Response.Listener<JSONArray>() {            @Override            public void onResponse(JSONArray response) {                try {                    TableLayout tv = (TableLayout) getView().findViewById(R.id.table);                   // tv.removeAllViewsInLayout();                    int flag = 1;                    JSONArray jr = new JSONArray(response.toString());                    for (int i = -1; i < response.length()   ; i++) {                        TableRow tr = new TableRow(getActivity().getApplicationContext());                        tr.setLayoutParams(new TableRow.LayoutParams(                                TableRow.LayoutParams.FILL_PARENT,                                TableRow.LayoutParams.FILL_PARENT));                        if (flag == 1) {                            TextView b9 = new TextView(getActivity().getApplicationContext());                            b9.setPadding(20, 0, 0, 0);                            b9.setTextSize(10);                            b9.setText("Drapeau");                            b9.setTextColor(Color.BLUE);                            tr.addView(b9);                            TextView b19 = new TextView(getActivity().getApplicationContext());                            b19.setPadding(10, 0, 0, 0);                            b19.setTextSize(15);                            b19.setText("Team_Name");                            b19.setTextColor(Color.BLUE);                            tr.addView(b19);                            TextView b29 = new TextView(getActivity().getApplicationContext());                            b29.setPadding(10, 0, 0, 0);                            b29.setText("Buts_marque");                            b29.setTextColor(Color.BLUE);                            b29.setTextSize(15);                            tr.addView(b29);                            TextView b39 = new TextView(getActivity().getApplicationContext());                            b39.setPadding(10, 0, 0, 0);                            b39.setText("But_Recu");                            b39.setTextColor(Color.BLUE);                            b39.setTextSize(15);                            tr.addView(b39);                            TextView b49 = new TextView(getActivity().getApplicationContext());                            b49.setPadding(10, 0, 0, 0);                            b49.setText("Win");                            b49.setTextColor(Color.BLUE);                            b49.setTextSize(15);                            tr.addView(b49);                            TextView b59 = new TextView(getActivity().getApplicationContext());                            b59.setPadding(10, 0, 0, 0);                            b59.setText("Null");                            b59.setTextColor(Color.BLUE);                            b59.setTextSize(15);                            tr.addView(b59);                            TextView b69 = new TextView(getActivity().getApplicationContext());                            b69.setPadding(10, 0, 0, 0);                            b69.setText("Lose");                            b69.setTextColor(Color.BLUE);                            b69.setTextSize(15);                            tr.addView(b69);                            TextView b79 = new TextView(getActivity().getApplicationContext());                            b79.setPadding(10, 0, 0, 0);                            b79.setText("Points");                            b79.setTextColor(Color.BLUE);                            b79.setTextSize(15);                            tr.addView(b79);                            tv.addView(tr);                            final View vline = new View(getActivity().getApplicationContext());                            vline.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, 2));                            vline.setBackgroundColor(Color.BLUE);                            tv.addView(vline);                            flag = 0;                        } else {                            final JSONObject object = jr.getJSONObject(i);                            Log.i("log_tag", "nom_equipe " + object.getString("nom_equipe") + ", but_marque: " + object.getInt("but_marque") + ", but_recu: " + object.getInt("but_recu")                            + ", nb_victoire: " + object.getInt("nb_victoire") + ", nb_null: " + object.getInt("nb_null")                            + ", nb_defaite: " + object.getInt("nb_defaite") + ", nb_point: " + object.getInt("nb_point")                            + ", drapeau: " + object.getString("drapeau_equipe"));                            final ImageView img = new ImageView(getActivity().getApplicationContext());                            img.setPadding(10 , 0, 0, 0);                              Glide.with(getActivity().getApplicationContext()).load(object.getString("drapeau_equipe"))                            .into(img);                            tr.addView(img);                            final TextView b1 = new TextView(getActivity().getApplicationContext());                            b1.setPadding(10, 0, 0, 0);                            b1.setTextSize(14);                            final String stime1 = object.getString("nom_equipe");                            b1.setText(stime1);                            b1.setTextColor(Color.BLACK);                            b1.setLinkTextColor(Color.BLACK);                            b1.setTypeface(null, Typeface.BOLD_ITALIC);                            Linkify.addLinks(b1, Linkify.ALL);                            final String stime77 = object.getString("continent");                            final String stime88 = object.getString(("coach"));                            final String stime98 = object.getString("winnercup");                            final String stime96 = object.getString("id_equipe");                            final String stime99 = object.getString("classementfifa");                            b1.setOnClickListener(new View.OnClickListener() {                                @Override                                public void onClick(View v) {                                    PlayersFragment fragment = new PlayersFragment();                                    getFragmentManager().beginTransaction().                                            replace(R.id.framee, fragment).addToBackStack(null).commit();                                  Bundle bundle = new Bundle();                                    bundle.putString("id", stime96);                                    fragment.setArguments(bundle);                                }                            });                            tr.addView(b1);                            TextView b2 = new TextView(getActivity().getApplicationContext());                            b2.setPadding(10, 0, 0, 0);                            String stime2 = object.getString("but_marque");                            b2.setText(stime2);                            b2.setTextColor(Color.BLACK);                            b2.setTextSize(20);                            tr.addView(b2);                            TextView b3 = new TextView(getActivity().getApplicationContext());                            b3.setPadding(10, 0, 0, 0);                            String stime3 = object.getString("but_recu");                            b3.setText(stime3);                            b3.setTextColor(Color.BLACK);                            b3.setTextSize(20);                            tr.addView(b3);                            TextView b4 = new TextView(getActivity().getApplicationContext());                            b4.setPadding(10, 0, 0, 0);                            String stime4 = object.getString("nb_victoire");                            b4.setText(stime4);                            b4.setTextColor(Color.BLACK);                            b4.setTextSize(20);                            tr.addView(b4);                            TextView b5 = new TextView(getActivity().getApplicationContext());                            b5.setPadding(10, 0, 0, 0);                            String stime5 = object.getString("nb_null");                            b5.setText(stime5);                            b5.setTextColor(Color.BLACK);                            b5.setTextSize(20);                            tr.addView(b5);                            TextView b6 = new TextView(getActivity().getApplicationContext());                            b6.setPadding(10, 0, 0, 0);                            String stime6 = object.getString("nb_defaite");                            b6.setText(stime6);                            b6.setTextColor(Color.BLACK);                            b6.setTextSize(20);                            tr.addView(b6);                            TextView b7 = new TextView(getActivity().getApplicationContext());                            b7.setPadding(10, 0, 0, 0);                            String stime7 = object.getString("nb_point");                            b7.setText(stime7);                            b7.setTextColor(Color.BLACK);                            b7.setTextSize(20);                            tr.addView(b7);                            tv.addView(tr);                            final View vline1 = new View(getActivity().getApplicationContext());                            vline1.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.MATCH_PARENT, 1));                            vline1.setBackgroundColor(Color.WHITE);                            tv.addView(vline1);                       //     flag = 1;                        }                   }                } catch (JSONException e) {                    e.printStackTrace();                }            }        }, new com.android.volley.Response.ErrorListener() {            @Override            public void onErrorResponse(VolleyError error) {            }        });        req = Volley.newRequestQueue(getActivity().getApplicationContext());        req.add(jsonArrayRequest);    }     public void sendjsonReq()    {       final JsonArrayRequest jsonreq = new JsonArrayRequest(url1,                new com.android.volley.Response.Listener<JSONArray>() {                    @Override                    public void onResponse(JSONArray response) {                        for (int i = 0; i < response.length(); i++) {                            try {                                final JSONObject obj = response.getJSONObject(i);                                Partie partie = new Partie();                                partie.setStade(obj.getString("stade"));                                partie.setEquipe1(obj.getString("equipe1"));                                partie.setEquipe2(obj.getString("equipe2"));                                partie.setHeure_match(obj.getString("heure_match"));                                partie.setDrapeau_equipe1(obj.getString("drapeau1"));                                partie.setDrapeau_equipe2(obj.getString("drapeau2"));                                SimpleDateFormat dt = new SimpleDateFormat("yyyy-MM-dd", Locale.FRANCE);                                try {                                    partie.setDate_match(dt.parse(obj.getString("date_match")));                                } catch (ParseException e) {                                    e.printStackTrace();                                }                                final String s1 = obj.getString("stade");                                listee.add(partie);                                liste.setOnItemClickListener(new AdapterView.OnItemClickListener() {                                    @Override                                    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {                                        //     Intent intent = new Intent(getApplicationContext(), PoolActivity.class);                                        //   intent.putExtra("Nom", s1);                                        // startActivity(intent);                                    }                                });                            } catch (JSONException e) {                                e.printStackTrace();                            }                        }                        adapter.notifyDataSetChanged();                    }                }, new com.android.volley.Response.ErrorListener() {            @Override            public void onErrorResponse(VolleyError error) {            }        });        req1 = Volley.newRequestQueue(getActivity().getApplicationContext());        req1.add(jsonreq);    }}